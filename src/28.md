### Условный экстремум. Метод множителей Лагранжа

Имеем функцию и условия: 

$$
    F(x_1,...,x_{n+m}) \\

    E: \begin{cases}
        \varphi_1(x_1,...,x_{n+m}) = 0 \\
        \dots \\
        \varphi_m(x_1,...,x_{n+m}) = 0 \\
    \end{cases}
$$

Требуется найти экстремум

---

**Определение** функция Лагранжа

$$
    L(x_1,...,x_{n+m}, \lambda_1,...,\lambda_m) = F(x_1,...,x_{n+m}) + \sum_{i=1}^m \lambda_i \varphi_i(x_1,...,x_{n+m})
$$

Или если переобозначить

$$
    x = (x_1,...,x_{n+m}) \quad \lambda = (\lambda_1,...,\lambda_m) \\
    L(x,\lambda) = F(x) + \sum_{i=1}^m \lambda_i \varphi_i(x_1,...,x_{n+m})
$$

---

**Теорема** Необходимое условие условного экстремума

Пусть все рассматриваемые функции непрерывные и дифференцируемые в окрестности точки $x^{(0)}$

$$
    F(x_1,...,x_{n+m}) \\

    E: \begin{cases}
        \varphi_1(x_1,...,x_{n+m}) = 0 \\
        \dots \\
        \varphi_m(x_1,...,x_{n+m}) = 0 \\
    \end{cases}
$$

При этом все функции условия независимы, а крайний нижний минор не равен 0 в окрестности $x^{(0)}$

$$
    \frac{D(\varphi_1,...,\varphi_m)}{D(x_{n+1},...,x_{n+m})} \neq 0
$$

**Тогда если $x^{(0)}$ - точка условного экстремума, то найдутся такие $\lambda_1,...,\lambda_m$ что**:

$$
    \left.\frac{\partial L}{\partial x_i}\right|_{x^{(0)}} = 

    \left(
        \frac{\partial F}{\partial x_i} + \sum_{k=1}^m\lambda_k \frac{\partial \varphi_k}{\partial x_i}
    \right) = 0
$$

Иными словами необходимое условие существования условного экстремума функции, совпадает с необходимым условием существования безусловного экстремума функции Лагранжа

---

> Решая систему таким образом мы присоединяем к $n+m$ уравнений в системе еще $m$ (с частными производными по функции Лагранжа) и решаем систему с $n+2m$ уравнений и получаем систему в которой одинаковое кол-во неизвестных и независимых уравнений, что позволяет нам однозначно ее решить

---

**Доказательство**:

1. Повторим действия из метода исключения переменных и подставим получившиеся выражения последних $m$ переменных в начальную функцию:

    $$
        \varPhi = F(x_1,...,x_n, f_1(x_1,...,x_n),...,f_m(x_1,...,x_n))
    $$

2. Очевидно, что если $x^{(0)}$ - точка условного экстремума $F$, то для $\varPhi$ она является точкой безусловного экстремума, что значит, что дифференциал $\varPhi$ в точке $x^{(0)}$ будет равен 0, т.к. все частные производные непрерывны и равны 0:

    $$
        d\varPhi(x^{(0)}) = 

        \left(

            \frac{\partial F}{\partial x_1}dx_1 + ... + 

            \frac{\partial F}{\partial x_{n+m}}dx_{n+m}  

        \right)|_{x^{(0)}} = 0
    $$

    > Здесь мы пользуемся так же инавриантность формы первого дифференциала, за счет чего мы выражаем $\varPhi$ только через $F$

3. Теперь неявные функции $f_1,...,f_m$ подставим в $\varphi_1,...,\varphi_k$ и получим тождества (тождества из теоремы о системе неявных функций, мы ведь получили выражения как раз из системы условий):

    $$
        \begin{cases}
            \varphi_1(x_1,...,x_n, f_1(x_1,...,x_n), ..., f_m(x_1,...,x_n)) \equiv 0 \\
            \dots \\
            \varphi_m(x_1,...,x_n, f_1(x_1,...,x_n), ..., f_m(x_1,...,x_n)) \equiv 0
        \end{cases}
    $$

4. Так же продифференцируем эти тождества в точке $x^{(0)}$, воспользовавшись свойством инвариантности первого дифференциала

    $$

        \left\{
            \begin{array}{l}
                
                \frac{\partial \varphi_1}{\partial x_1}dx_1 + ...
                \frac{\partial \varphi_1}{\partial x_{n+m}}dx_{n+m} = 0 \\
                \dots \\
                
                \frac{\partial \varphi_m}{\partial x_1}dx_1 + ...
                \frac{\partial \varphi_m}{\partial x_{n+m}}dx_{n+m} = 0 \\

            \end{array}
        \right.
    $$

5. Теперь скомбинируем получившиеся выражения - к дифференциалу функции $\varPhi$ прибавим каждое уравнение из системы выше (дифференциалы системы условий), каждый из которых домножим на некоторый коэффициент $\lambda_1,...,\lambda_m$:

    $$
        \frac{\partial F}{\partial x_1}dx_1 + ... + 

        \frac{\partial F}{\partial x_{n+m}}dx_{n+m} + 

        \sum_{i=1}^m

        \left(
            \frac{\partial \varphi_i}{\partial x_1}dx_1 + ...
                \frac{\partial \varphi_i}{\partial x_{n+m}}dx_{n+m}
        \right)\lambda_i = 0
    $$

    перегруппируем слагаемые по $dx_1,...,dx_{n+m}$:

    $$
        \left(

            \frac{\partial F}{\partial x_1} + \sum_{i=1}^m \frac{\partial \varphi_i}{\partial x_1}\lambda_i

        \right) dx_1 + ... + 

        \left(

            \frac{\partial F}{\partial x_{n+m}} + \sum_{i=1}^m \frac{\partial \varphi_i}{\partial x_{n+m}}\lambda_i

        \right) dx_{n+m} = 0 \text{ \quad в точке } x^{(0)}
    $$

6. Теперь нужно вычислить коэффициенты $\lambda$. Выберем лямбды через последние $m$ слагаемых:

    $$
        \frac{\partial F}{\partial x_i} + \sum_{k=1}^m \frac{\partial \varphi_k}{x_i}\lambda_k = 0 \text{\quad в точке $x^{(0)}$}
    $$

    Т.к. функции в системе условий независимы и якобиан матрицы системы по последним $m$ переменным (из условия) не равен 0, мы знаем, что данная система, явялется системой линейных алгебраических уравнений, что позволит нам однозначно найти $\lambda_1,...,\lambda_m$

7. Найденные коэффициенты подставим в уравнение

    $$
        \left(

            \frac{\partial F}{\partial x_1} + \sum_{i=1}^m \frac{\partial \varphi_i}{\partial x_1}\lambda_i

        \right) dx_1 + ... + 

        \left(

            \frac{\partial F}{\partial x_{n+m}} + \sum_{i=1}^m \frac{\partial \varphi_i}{\partial x_{n+m}}\lambda_i

        \right) dx_{n+m} = 0    
    $$

    Заметим, что за счет подстановки этих коэффициентов последние $m$ слагаемых обнулились, а значит остались только первые $n$ (в точке $x^{(0)}$):

    $$
        \sum_{i=1}^n

        \left(
            \frac{\partial F}{\partial x_i} + \sum_{k=1}^m \frac{\partial\varphi_k}{\partial x_i}\lambda_k
        \right)dx_i = 0
    $$

    Данное выражение должно обращаться в 0 для любых $dx_1,...,dx_n$ (т.е. по сути во всей окрестности), тогда получается, что соответственно каждый коэффициент должен быть равен 0 (первые $n$ по только что полученному выражению, а последние $m$ по выбору коэффициентов Лагранжа)

$$
    \blacksquare
$$

---

> Точки заданной условиями области $E$ в которых ранг $\frac{D(\varphi_1,...,\varphi_m)}{D(x_{n+1},...,x_{n+m})}$ меньше $m$ следует исследовать отдельно

---

**Теорема** достаточно условие условного экстремума

1. Функции $F, \varphi_1,...,\varphi_m$ - дважды непрерывно дифференцируемы в окрестности точки $x^{(0)}$
2. $x^{(0)}$ удовлетворяет необходимым условиям условного экстремума (т.е. имеются коэффициенты Лагранжа при которых частные производные функции Лагранжа обращаются в 0 и $\frac{D(\varphi_1,...,\varphi_m)}{D(x_{n+1},...,x_{n+m})}\neq 0$ в этой точке)
3. $dx_1,...,dx_{n+m}$ не равны одновременно 0 и удовлетворяют 

$$
    \left\{
        \begin{array}{l}
            
            \frac{\partial \varphi_1}{\partial x_1}dx_1 + ...
            \frac{\partial \varphi_1}{\partial x_{n+m}}dx_{n+m} = 0 \\
            \dots \\
            
            \frac{\partial \varphi_m}{\partial x_1}dx_1 + ...
            \frac{\partial \varphi_m}{\partial x_{n+m}}dx_{n+m} = 0 \\
        \end{array}
    \right.
$$

Тогда если

$$
    d^2L(x^{(0)}) > 0 \Rightarrow \text{ точка минимума} \\
    d^2L(x^{(0)}) < 0 \Rightarrow \text{ точка максимума}
$$

---

> Условие 3 из теоремы требуется в силу того, что форма второго дифференциала не обладает свойством инвариантности
> 
> Достаточное условие условного экстремума совпадает с достаточным условием безусловного экстремума функции Лагранжа. Для доказательства достаточно показать, что $d^2L(x^{(0)}) = d^2\varPhi(x^{(0)})$ 
